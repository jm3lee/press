#!/bin/bash
#
# Description:
#   Remove the specified build directories and then invoke
#   `make` inside the Docker Compose `shell` service. Runs
#   from the project root (/data) so the default `makefile`
#   is used, allowing a clean rebuild of one or more targets.
#
# Usage:
#   remake [TARGETS...]
#
# Example:
#   remake build webp
#
# Each argument is recursively deleted with `rm -rf` before
# delegating to `make` so the build artifacts are regenerated
# from scratch.

rm -rf "$@"
docker compose run \
  --rm --entrypoint make -u "$(id -u)" -w /data \
  shell "$@"

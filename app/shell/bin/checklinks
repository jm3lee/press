#!/usr/bin/env bash
set -euo pipefail

if [[ $# -ne 1 ]]; then
    echo "Usage: $0 <url>" >&2
    exit 1
fi

log=$(mktemp)
trap 'rm -f "$log"' EXIT

pattern='broken link!!!|ERROR [45][0-9]{2}'

wget --spider \
    --recursive \
    --no-directories \
    --level=3 \
    --hsts-file=/dev/null \
    "$1" 2>&1 | tee log/checklinks.txt
exit ${PIPESTATUS[0]}
